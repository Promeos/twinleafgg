// This file was auto-generated by the card stub generator.
// Card effects were implemented by an agent.
// If you have any questions or feedback, reach out to @C4 in the discord.

import { TrainerCard } from '../../game/store/card/trainer-card';
import { TrainerType, CardType } from '../../game/store/card/card-types';
import { StoreLike, State, StateUtils } from '../../game';
import { Effect } from '../../game/store/effects/effect';
import { DealDamageEffect } from '../../game/store/effects/attack-effects';
import { IS_TOOL_BLOCKED } from '../../game/store/prefabs/prefabs';

export class SpongyGloves extends TrainerCard {
  public trainerType: TrainerType = TrainerType.TOOL;
  public regulationMark: string = 'E';
  public set: string = 'FST';
  public setNumber: string = '243';
  public cardImage: string = 'assets/cardback.png';
  public name: string = 'Spongy Gloves';
  public fullName: string = 'Spongy Gloves (FST 243)';
  public legacyFullName = 'Spongy Gloves FST';
  public text: string = 'The attacks of the Pokémon this card is attached to do 30 more damage to your opponent\'s Active Water Pokémon (before applying Weakness and Resistance). You may play any number of Item cards during your turn. Attach a Pokémon Tool to 1 of your Pokémon that doesn\'t already have a Pokémon Tool attached.';

  public reduceEffect(store: StoreLike, state: State, effect: Effect): State {
    // Spongy Gloves: +30 damage to opponent's Active Water Pokemon
    // Ref: set-paldea-evolved/choice-belt.ts (DealDamageEffect with source.tools.includes, ToolEffect check)
    if (effect instanceof DealDamageEffect && effect.source.tools.includes(this)) {
      const player = effect.player;
      const opponent = StateUtils.getOpponent(state, player);

      // Check if tool effect is blocked
      if (IS_TOOL_BLOCKED(store, state, player, this)) {
        return state;
      }

      // Only applies to opponent's active Pokemon
      if (effect.target !== opponent.active) {
        return state;
      }

      // Check if the target is a Water Pokemon
      const targetCard = opponent.active.getPokemonCard();
      if (targetCard && targetCard.cardType === CardType.WATER) {
        const attack = effect.attack;
        if (attack && attack.damage > 0) {
          effect.damage += 30;
        }
      }
    }

    return state;
  }
}
