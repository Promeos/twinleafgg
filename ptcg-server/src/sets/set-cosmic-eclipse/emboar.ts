// This file was auto-generated by the card stub generator.
// Card effects were implemented by an agent.
// If you have any questions or feedback, reach out to @C4 in the discord.

import { PokemonCard } from '../../game/store/card/pokemon-card';
import { Stage, CardType, EnergyType } from '../../game/store/card/card-types';
import { PowerType, StoreLike, State } from '../../game';
import { Effect } from '../../game/store/effects/effect';
import { EvolveEffect } from '../../game/store/effects/game-effects';
import { IS_ABILITY_BLOCKED, LOOK_AT_TOP_X_CARDS_AND_ATTACH_UP_TO_Y_ENERGY } from '../../game/store/prefabs/prefabs';

export class Emboar extends PokemonCard {
  public stage: Stage = Stage.STAGE_2;
  public evolvesFrom: string = 'Pignite';
  public cardType: CardType = R;
  public hp: number = 170;
  public weakness = [{ type: W }];
  public retreat = [C, C, C, C];

  public powers = [{
    name: 'Explosive Fire Dance',
    powerType: PowerType.ABILITY,
    text: 'When you play this Pokémon from your hand to evolve 1 of your Pokémon during your turn, you may look at the top 8 cards of your deck and attach any number of basic Energy cards you find there to your Pokémon in any way you like. Shuffle the other cards back into your deck.'
  }];

  public attacks = [
    {
      name: 'Heat Blast',
      cost: [R, C, C, C],
      damage: 160,
      text: ''
    }
  ];

  public set: string = 'CEC';
  public setNumber: string = '33';
  public cardImage: string = 'assets/cardback.png';
  public name: string = 'Emboar';
  public fullName: string = 'Emboar CEC';

  public reduceEffect(store: StoreLike, state: State, effect: Effect): State {
    // Ability: Explosive Fire Dance
    // Ref: set-pokemon-151/vileplume.ts (Fully Blooming Energy)
    if (effect instanceof EvolveEffect && effect.pokemonCard === this) {
      const player = effect.player;

      if (IS_ABILITY_BLOCKED(store, state, player, this)) {
        return state;
      }

      return LOOK_AT_TOP_X_CARDS_AND_ATTACH_UP_TO_Y_ENERGY(
        store,
        state,
        player,
        8,
        8,
        {
          energyFilter: { energyType: EnergyType.BASIC },
          remainderDestination: 'shuffle'
        }
      );
    }

    return state;
  }
}
